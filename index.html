<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Converter | CSV & JSON Export</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Excel Converter</h1>
            <p>Professional data extraction and export</p>
        </header>

        <main>
            <div class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5m0 0L7 8m5-5v12"/>
                    </svg>
                    <h2>Upload Excel File</h2>
                    <p>Drag and drop file here or click to browse</p>
                    <input type="file" id="fileInput" accept=".xlsx,.xls" hidden>
                    <button class="btn-primary" id="browseBtn">Browse Files</button>
                    <span class="file-types">Supported: .xlsx, .xls</span>
                </div>

                <div class="file-info" id="fileInfo" style="display: none;">
                    <div class="file-details">
                        <div class="file-icon-wrapper">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/>
                                <polyline points="13 2 13 9 20 9"/>
                            </svg>
                        </div>
                        <div class="file-meta">
                            <p class="file-name" id="fileName"></p>
                            <p class="file-size" id="fileSize"></p>
                        </div>
                        <button class="btn-icon" id="removeBtn" title="Remove file">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                            </svg>
                        </button>
                    </div>
                    <button class="btn-primary" id="convertBtn">Process File</button>
                </div>
            </div>

            <div class="loading" id="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Processing...</p>
            </div>

            <div class="row-preview" id="rowPreview" style="display: none;">
                <div class="selection-header">
                    <h2>Select Header Row</h2>
                    <p>Preview the first rows and choose which one contains your column headers</p>
                </div>
                
                <div class="preview-table-wrapper">
                    <table class="preview-table" id="previewTable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Row #</th>
                                <th>Column A</th>
                                <th>Column B</th>
                                <th>Column C</th>
                                <th>Column D</th>
                                <th>Column E</th>
                            </tr>
                        </thead>
                        <tbody id="previewTableBody">
                        </tbody>
                    </table>
                </div>
                
                <div class="selection-footer">
                    <p id="headerRowText" class="count-text">Row 0 selected as header</p>
                    <button class="btn-primary" id="continueBtn">Continue with Selected Header</button>
                </div>
            </div>

            <div class="column-selection" id="columnSelection" style="display: none;">
                <div class="selection-header">
                    <h2>Column Selection</h2>
                    <p>Select the columns to include in your export</p>
                    <div class="selection-controls">
                        <button class="btn-secondary" id="selectAllBtn">Select All</button>
                        <button class="btn-secondary" id="deselectAllBtn">Deselect All</button>
                    </div>
                </div>
                
                <div class="columns-grid" id="columnsGrid"></div>
                
                <div class="selection-footer">
                    <p id="selectedCount" class="count-text">All columns selected</p>
                    <button class="btn-primary" id="proceedBtn">Generate Export</button>
                </div>
            </div>

            <div class="result" id="result" style="display: none;">
                <div class="result-header">
                    <svg class="check-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"/>
                    </svg>
                    <h3>Export Ready</h3>
                    <p id="resultMessage"></p>
                </div>
                <div class="export-section">
                    <p class="export-label">Select export format:</p>
                    <div class="export-buttons">
                        <button class="btn-export" id="downloadCsvBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                                <line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/>
                            </svg>
                            <span>Download CSV</span>
                        </button>
                        <button class="btn-export" id="downloadJsonBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                                <path d="M10 12a2 2 0 0 0-2 2v2a2 2 0 0 1-2 2M14 12a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2"/>
                            </svg>
                            <span>Download JSON</span>
                        </button>
                    </div>
                </div>
                <button class="btn-secondary btn-block" id="newFileBtn">Process Another File</button>
            </div>

            <div class="error" id="error" style="display: none;">
                <svg class="error-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
                <h3>Processing Error</h3>
                <p id="errorMessage"></p>
                <button class="btn-secondary" id="retryBtn">Try Again</button>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>
